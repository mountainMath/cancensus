<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Additional datasets: Annual T1FF taxfiler data • cancensus</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/simplex/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Additional datasets: Annual T1FF taxfiler data">
<meta property="og:description" content="cancensus">
<meta property="og:image" content="https://mountainmath.github.io/cancensus/logo.png">
<meta property="og:image:alt" content="cancensus">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@vb_jens">
<meta name="twitter:site" content="https://mountainmath.github.io/cancensus/">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-107390160-3"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-107390160-3');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cancensus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/cancensus.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Making_maps_with_cancensus.html">Making maps with cancensus</a>
    </li>
    <li>
      <a href="../articles/data_discovery.html">Data discovery</a>
    </li>
    <li>
      <a href="../articles/intersecting_geometries.html">Finding intersecting geometries from custom data</a>
    </li>
    <li>
      <a href="../articles/Dwellings_by_document_type_cross_tabulation.html">Additional datasets: Structural type of dwelling by document type</a>
    </li>
    <li>
      <a href="../articles/Taxfiler_Data.html">Additional datasets: Annual T1FF taxfiler data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mountainMath/cancensus/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Taxfiler_Data_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Additional datasets: Annual T1FF taxfiler data</h1>
            <h3 class="subtitle">Dataset background and example usage</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mountainMath/cancensus/blob/master/vignettes/Taxfiler_Data.Rmd"><code>vignettes/Taxfiler_Data.Rmd</code></a></small>
      <div class="hidden name"><code>Taxfiler_Data.Rmd</code></div>

    </div>

    
    
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>Through collaboration with the <a href="https://www.cmhc-schl.gc.ca/">Canadian Mortgage and Housing Corporation</a> (CMHC), CensusMapper has added and open-sourced annual T1FF taxfiler data which provides an annual look at some basic demographic variables. Data is available via the <code>cancensus</code> package for the years 2001 through 2017. The T1FF dataset contains information on:</p>
<ul>
<li>individual income</li>
<li>government transfers</li>
<li>family income</li>
<li>family composition</li>
<li>taxfilers by age groups</li>
<li>taxfilers and dependants by age groups</li>
<li>marital status and select other demographic variables</li>
</ul>
<p>The data comes in varying Census geographies, depending on the year. Retrieving any annual dataset via <code>get_census</code> will automatically reference to the correct Census geography and attach the correct spatial boundaries.</p>
<p>The taxfiler data is organized with consistent internal referencing. The identifier for the number of families in low income in 2017 is “v_TX2017_786” and that for all families is “v_TX2017_607”, and the ones for the other years are given by simply swapping out the year. This makes the variables selection process easy.</p>
</div>
<div id="example-usage-constructing-a-multi-year-series-of-families-in-low-income-status" class="section level2">
<h2 class="hasAnchor">
<a href="#example-usage-constructing-a-multi-year-series-of-families-in-low-income-status" class="anchor"></a>Example usage: constructing a multi-year series of families in low-income status</h2>
<p>As an example we will explore a multi-year time series for families in low income. Data on low income families is available for years 2004 and later, we will start with 2006 just so that the data fits on a nice grid.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Packages used for example</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mountainMath/cancensus">cancensus</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span></code></pre></div>
<p>To see all available T1FF datasets and their reference codes we can use <code><a href="../reference/list_census_datasets.html">list_census_datasets()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/list_census_datasets.html">list_census_datasets</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"taxfiler"</span>,<span class="va">description</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 19 x 6</span>
<span class="co">#&gt;    dataset description   geo_dataset attribution    reference reference_url     </span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;          &lt;chr&gt;     &lt;chr&gt;             </span>
<span class="co">#&gt;  1 TX2000  2000 T1FF ta… CA1996      StatCan 2000 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt;  2 TX2001  2001 T1FF ta… CA01        StatCan 2001 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt;  3 TX2002  2002 T1FF ta… CA01        StatCan 2002 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt;  4 TX2003  2003 T1FF ta… CA01        StatCan 2003 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt;  5 TX2004  2004 T1FF ta… CA01        StatCan 2004 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt;  6 TX2005  2005 T1FF ta… CA01        StatCan 2005 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt;  7 TX2006  2006 T1FF ta… CA06        StatCan 2006 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt;  8 TX2007  2007 T1FF ta… CA06        StatCan 2007 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt;  9 TX2008  2008 T1FF ta… CA06        StatCan 2008 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt; 10 TX2009  2009 T1FF ta… CA06        StatCan 2009 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt; 11 TX2010  2010 T1FF ta… CA06        StatCan 2010 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt; 12 TX2011  2011 T1FF ta… CA06        StatCan 2011 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt; 13 TX2012  2012 T1FF ta… CA11        StatCan 2012 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt; 14 TX2013  2013 T1FF ta… CA11        StatCan 2013 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt; 15 TX2014  2014 T1FF ta… CA11        StatCan 2014 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt; 16 TX2015  2015 T1FF ta… CA11        StatCan 2015 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt; 17 TX2016  2016 T1FF ta… CA16        StatCan 2016 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt; 18 TX2017  2017 T1FF ta… CA16        StatCan 2017 … 72-212-X  https://www150.st…</span>
<span class="co">#&gt; 19 TX2018  2018 T1FF ta… CA16        StatCan 2018 … 72-212-X  https://www150.st…</span></code></pre></div>
<p>And, as an example, available data vectors for one such T1FF dataset.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/list_census_vectors.html">list_census_vectors</a></span><span class="op">(</span><span class="st">'TX2017'</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 818 x 7</span>
<span class="co">#&gt;    vector  type  label   units    parent_vector aggregation  details            </span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;fct&gt; &lt;chr&gt;   &lt;fct&gt;    &lt;chr&gt;         &lt;chr&gt;        &lt;chr&gt;              </span>
<span class="co">#&gt;  1 v_TX20… Total Taxfil… Number   &lt;NA&gt;          Additive     Tax data 2017; Ind…</span>
<span class="co">#&gt;  2 v_TX20… Total % 0-24  Percent… v_TX2017_1    Average of … Tax data 2017; Ind…</span>
<span class="co">#&gt;  3 v_TX20… Total % 25-44 Percent… v_TX2017_1    Average of … Tax data 2017; Ind…</span>
<span class="co">#&gt;  4 v_TX20… Total % 45-64 Percent… v_TX2017_1    Average of … Tax data 2017; Ind…</span>
<span class="co">#&gt;  5 v_TX20… Total % 65+   Percent… v_TX2017_1    Average of … Tax data 2017; Ind…</span>
<span class="co">#&gt;  6 v_TX20… Total Averag… Ratio    v_TX2017_1    Average of … Tax data 2017; Ind…</span>
<span class="co">#&gt;  7 v_TX20… Total % fema… Percent… v_TX2017_1    Average of … Tax data 2017; Ind…</span>
<span class="co">#&gt;  8 v_TX20… Total % marr… Percent… v_TX2017_1    Average of … Tax data 2017; Ind…</span>
<span class="co">#&gt;  9 v_TX20… Total % in a… Percent… v_TX2017_1    Average of … Tax data 2017; Ind…</span>
<span class="co">#&gt; 10 v_TX20… Total All pe… Number   &lt;NA&gt;          Additive     Tax data 2017; Ind…</span>
<span class="co">#&gt; # … with 808 more rows</span></code></pre></div>
<p>This particular dataset has over 800 individual vectors. The vector codes follow a regular pattern across different years, and we can use this to quickly identify all the relevant variables of interest across multiple datasets. We can utilized the <a href="https://censusmapper.ca/api/CA16#api_variable">CensusMapper gaphical variable selection interface</a>, which can also be reached by calling <code><a href="../reference/explore_census_vectors.html">explore_census_vectors()</a></code> from the R console. For this example we are interested in low income families and note that the internal CensusMapper vector for all families is of the form *v_TX<year>_607* and that for all families in low income is *v_TX<year>_786*.</year></year></p>
<p>While the geography varies across Census periods, the call to <code>get_census</code> will automatically attach the correct geography for each annual dataset. We pick four years to look at low income families.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">years</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2006</span>,<span class="fl">2011</span>,<span class="fl">2014</span>,<span class="fl">2018</span><span class="op">)</span>
<span class="co"># Attribution for the dataset to be used in graphs</span>
<span class="va">attribution</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dataset_attribution.html">dataset_attribution</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"TX"</span>,<span class="va">years</span><span class="op">)</span><span class="op">)</span>

<span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="va">years</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"TX"</span>,<span class="va">year</span><span class="op">)</span>
    <span class="va">vectors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Families"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"v_"</span>,<span class="va">dataset</span>,<span class="st">"_607"</span><span class="op">)</span>,
                 <span class="st">"CFLIM-AT"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"v_"</span>,<span class="va">dataset</span>,<span class="st">"_786"</span><span class="op">)</span><span class="op">)</span>
    
    <span class="fu"><a href="../reference/get_census.html">get_census</a></span><span class="op">(</span><span class="va">dataset</span>,regions<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>CMA<span class="op">=</span><span class="st">"59933"</span><span class="op">)</span>,vectors <span class="op">=</span> <span class="va">vectors</span>,
                    geo_format <span class="op">=</span> <span class="st">'sf'</span>, level<span class="op">=</span><span class="st">"CT"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"GeoUID"</span>,<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">vectors</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Year<span class="op">=</span><span class="va">year</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>share<span class="op">=</span><span class="va">`CFLIM-AT`</span><span class="op">/</span><span class="va">Families</span><span class="op">)</span></code></pre></div>
<p>Here we also re-organized the data by year. All that’s left is to plot the data, one year at a time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">plot_data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">share</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.1</span>,color<span class="op">=</span><span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="st">"Year"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html">scale_fill_viridis_c</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span>,option <span class="op">=</span> <span class="st">"inferno"</span>,
                       trans<span class="op">=</span><span class="st">"log"</span>,breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>datum<span class="op">=</span><span class="cn">NA</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">123.4</span>, <span class="op">-</span><span class="fl">122.5</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">49.01</span>, <span class="fl">49.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Share of census families in low income"</span>,fill<span class="op">=</span><span class="st">"Share"</span>,
       caption<span class="op">=</span><span class="va">attribution</span><span class="op">)</span></code></pre></div>
<p><img src="Taxfiler_Data_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>We may be tempted to re-arrange the data to create timelines, but we have to be careful as census geographies change over time. Inspecting the dataset tables at the top informs us that the 2006 through 2011 data all come on the common 2006 census geography, so the 2006 and 2011 tax data are directly comparable.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">change_data</span> <span class="op">&lt;-</span> <span class="va">plot_data</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Year</span><span class="op">==</span><span class="fl">2006</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">GeoUID</span>,`2006`<span class="op">=</span><span class="va">share</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">plot_data</span> <span class="op">%&gt;%</span>
              <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html">st_set_geometry</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">%&gt;%</span>
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">Year</span><span class="op">==</span><span class="fl">2011</span><span class="op">)</span> <span class="op">%&gt;%</span> 
              <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">GeoUID</span>,`2011`<span class="op">=</span><span class="va">share</span><span class="op">)</span>,
            by<span class="op">=</span><span class="st">"GeoUID"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>change<span class="op">=</span><span class="va">`2011`</span><span class="op">-</span><span class="va">`2006`</span><span class="op">)</span>
  
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">change_data</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">change</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu">scales</span><span class="fu">::</span><span class="va"><a href="https://scales.r-lib.org/reference/label_percent.html">percent</a></span><span class="op">)</span> <span class="op">+</span>
  <span class="co">#scale_fill_viridis_c(labels=scales::percent,option = "inferno") +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">coord_sf</a></span><span class="op">(</span>datum<span class="op">=</span><span class="cn">NA</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">123.4</span>, <span class="op">-</span><span class="fl">122.5</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">49.01</span>, <span class="fl">49.4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Change in share of census families in low income 2006-2011"</span>,fill<span class="op">=</span><span class="st">"Percentage\npoint change"</span>,caption<span class="op">=</span><span class="fu"><a href="../reference/dataset_attribution.html">dataset_attribution</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"TX"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2006</span>,<span class="fl">2011</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="Taxfiler_Data_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Analyzing change over longer timelines that span changes in Census geometries involves more work, the <a href="https://mountainmath.github.io/tongfen/index.html">tongfen package</a> facilitates this and provides a convenient interface for generating timelines spanning geometries from several Census years.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://mountainmath.ca">Jens von Bergmann</a>, <a href="https://dshkol.com">Dmitry Shkolnik</a>, Aaron Jacobs.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
